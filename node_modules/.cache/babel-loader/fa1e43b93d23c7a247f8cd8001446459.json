{"ast":null,"code":"import _slicedToArray from\"C:/Users/linar/praktikumLenovo/diplom/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from\"react\";import\"./MoviesCardList.css\";import MoviesCard from\"../MoviesCard/MoviesCard\";import{MovieContext}from\"../../../contexts/MovieContext\";import{VisibleRowsContext}from\"../../../contexts/VisibleRowsContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var movieCardStartColumns=function movieCardStartColumns(){if(window.innerWidth>=1200)return 3;if(window.innerWidth>=700)return 2;return 1;};function MoviesCardList(_ref){var cards=_ref.cards;var _useContext=useContext(MovieContext),savedMovies=_useContext.savedMovies,addMovie=_useContext.addMovie,deleteMovie=_useContext.deleteMovie;var _useContext2=useContext(VisibleRowsContext),addRows=_useContext2.addRows,getRows=_useContext2.getRows;var startVisibleRows=getRows();var _useState=useState(movieCardStartColumns()),_useState2=_slicedToArray(_useState,2),columns=_useState2[0],setColumns=_useState2[1];var _useState3=useState(startVisibleRows*columns),_useState4=_slicedToArray(_useState3,2),cardCount=_useState4[0],setCardCount=_useState4[1];var calColumns=function calColumns(cards){var newColumns=movieCardStartColumns();setColumns(newColumns);var requiredMovieCardCount=newColumns*startVisibleRows;if(cards.length<requiredMovieCardCount){setCardCount(cards.length);}else{setCardCount(requiredMovieCardCount);}};useEffect(function(){calColumns({cards:cards});window.addEventListener(\"resize\",calColumns);return function(){window.removeEventListener(\"resize\",calColumns);};},[]);var loadMoreCards=function loadMoreCards(){setCardCount(cardCount+columns);addRows();};var visibleCards=cards.slice(0,cardCount);return/*#__PURE__*/_jsxs(\"section\",{className:\"movies-card-list \".concat(cardCount<cards.length?\"\":\"movies-card-list_padding\"),children:[/*#__PURE__*/_jsx(\"ul\",{className:\"movies-card-list__container\",children:visibleCards.map(function(movie,index){return/*#__PURE__*/_jsx(MoviesCard,{title:movie.title,duration:movie.duration,backdrop:movie.backdrop,isSaved:savedMovies.some(function(savedMovie){return savedMovie.title===movie.title;}),onAddToSaved:addMovie,onRemoveFromSaved:deleteMovie},index);})}),cardCount<cards.length&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"movies-card-list__button link\",onClick:loadMoreCards,children:\"\\u0415\\u0449\\u0451\"})]});}export default MoviesCardList;","map":{"version":3,"names":["React","useState","useEffect","useContext","MoviesCard","MovieContext","VisibleRowsContext","movieCardStartColumns","window","innerWidth","MoviesCardList","cards","savedMovies","addMovie","deleteMovie","addRows","getRows","startVisibleRows","columns","setColumns","cardCount","setCardCount","calColumns","newColumns","requiredMovieCardCount","length","addEventListener","removeEventListener","loadMoreCards","visibleCards","slice","map","movie","index","title","duration","backdrop","some","savedMovie"],"sources":["C:/Users/linar/praktikumLenovo/diplom/movies-explorer-frontend/src/components/Movies/MoviesCardList/MoviesCardList.jsx"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\n\r\nimport \"./MoviesCardList.css\";\r\nimport MoviesCard from \"../MoviesCard/MoviesCard\";\r\nimport { MovieContext } from \"../../../contexts/MovieContext\";\r\nimport { VisibleRowsContext } from \"../../../contexts/VisibleRowsContext\";\r\n\r\nconst movieCardStartColumns = () => {\r\n  if (window.innerWidth >= 1200) return 3;\r\n  if (window.innerWidth >= 700) return 2;\r\n  return 1;\r\n};\r\n\r\nfunction MoviesCardList({ cards }) {\r\n  const { savedMovies, addMovie, deleteMovie } = useContext(MovieContext);\r\n  const { addRows, getRows } = useContext(VisibleRowsContext);\r\n  const startVisibleRows = getRows();\r\n  const [columns, setColumns] = useState(movieCardStartColumns());\r\n  const [cardCount, setCardCount] = useState(startVisibleRows * columns);\r\n\r\n  const calColumns = (cards) => {\r\n    const newColumns = movieCardStartColumns();\r\n    setColumns(newColumns);\r\n    const requiredMovieCardCount = newColumns * startVisibleRows;\r\n    if (cards.length < requiredMovieCardCount) {\r\n      setCardCount(cards.length);\r\n    } else {\r\n      setCardCount(requiredMovieCardCount);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    calColumns({ cards });\r\n    window.addEventListener(\"resize\", calColumns);\r\n    return () => {\r\n      window.removeEventListener(\"resize\", calColumns);\r\n    };\r\n  }, []);\r\n\r\n  const loadMoreCards = () => {\r\n    setCardCount(cardCount + columns);\r\n    addRows();\r\n  };\r\n\r\n  const visibleCards = cards.slice(0, cardCount);\r\n\r\n  return (\r\n    <section\r\n      className={`movies-card-list ${cardCount < cards.length ? \"\" : \"movies-card-list_padding\"\r\n        }`}\r\n    >\r\n      <ul className=\"movies-card-list__container\">\r\n        {visibleCards.map((movie, index) => (\r\n          <MoviesCard\r\n            key={index}\r\n            title={movie.title}\r\n            duration={movie.duration}\r\n            backdrop={movie.backdrop}\r\n            isSaved={savedMovies.some(\r\n              (savedMovie) => savedMovie.title === movie.title\r\n            )}\r\n            onAddToSaved={addMovie}\r\n            onRemoveFromSaved={deleteMovie}\r\n          />\r\n        ))}\r\n      </ul>\r\n      {cardCount < cards.length && (\r\n        <button\r\n          type=\"button\"\r\n          className=\"movies-card-list__button link\"\r\n          onClick={loadMoreCards}\r\n        >\r\n          Ещё\r\n        </button>\r\n      )}\r\n    </section>\r\n  );\r\n}\r\n\r\nexport default MoviesCardList;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}